# Demo de Identidad Digital ZK - Zenroom + SvelteKit - Are you a kid?

Una demostraci√≥n completa de aplicaci√≥n de identidad digital que preserva la privacidad usando **Zero Knowledge Proofs** con Zenroom y SvelteKit.

![Demo Screenshot](https://img.shields.io/badge/Demo-Live-green)

## üåü ¬øQu√© es Zenroom?

**Zenroom** es una m√°quina virtual criptogr√°fica ultra-compacta (<2MB) dise√±ada para ejecutar operaciones criptogr√°ficas avanzadas de manera segura y determinista. Desarrollada por [Dyne.org](https://dyne.org), Zenroom ejecuta **Zencode** - un lenguaje de dominio espec√≠fico (DSL) legible como ingl√©s natural para operaciones criptogr√°ficas.

### Caracter√≠sticas principales de Zenroom:

- **üîí Seguridad total**: M√°quina virtual aislada sin acceso a I/O del sistema
- **üéØ Determinismo**: Mismas entradas producen siempre mismas salidas
- **üì± Multiplataforma**: Funciona en browsers, m√≥viles, servidores, IoT
- **üîê Protocolos avanzados**: Soporte nativo para Coconut, BBS+, Longfellow-ZK
- **‚ö° Ultra-compacto**: Menos de 2MB, perfecto para aplicaciones embebidas
- **üåê Sin dependencias**: No requiere librer√≠as externas

### Protocolos Zero Knowledge soportados:

- **Coconut**: Threshold issuance y selective disclosure credentials
- **BBS+**: Signatures con selective disclosure optimizado para W3C Verifiable Credentials
- **Longfellow-ZK**: Compatibilidad con documentos oficiales (ISO 18013.5.1 mDL)
- **Range Proofs**: Verificaci√≥n de rangos sin revelar valores exactos
- **Membership Proofs**: Demostrar pertenencia a grupos sin revelar identidad

## üéØ ¬øQu√© hace esta aplicaci√≥n demo?

Esta demo demuestra c√≥mo crear una **aplicaci√≥n de identidad digital que preserva la privacidad** usando Zero Knowledge Proofs. Permite:

### Funcionalidades principales:

#### üÜî Gesti√≥n de Identidad Digital
- **Crear identidades criptogr√°ficas** con m√∫ltiples keypairs (Coconut, BLS, ECDSA)
- **Calcular autom√°ticamente la edad** y estado de mayor√≠a de edad
- **Exportar/importar identidades** de forma segura
- **Sistema de backup** con claves p√∫blicas/privadas separadas

#### üîê Generaci√≥n de Pruebas Zero Knowledge
- **Pruebas de edad**: Verificar mayor√≠a de edad sin revelar fecha exacta de nacimiento
- **Range proofs**: Demostrar edad en rango (ej: 18-65 a√±os) sin revelar edad exacta
- **Selective disclosure**: Revelar solo atributos espec√≠ficos (nacionalidad, verificaci√≥n)
- **Membership proofs**: Demostrar pertenencia a grupos sin revelar identidad

#### üîç Verificaci√≥n Sin Revelar Datos
- **Verificaci√≥n Coconut**: Para threshold credentials
- **Verificaci√≥n BBS+**: Para selective disclosure
- **Simulaci√≥n blockchain**: Verificaci√≥n on-chain con datos de transacci√≥n
- **Historial de verificaciones** con estad√≠sticas

#### ‚õìÔ∏è Integraci√≥n Blockchain
- **Preparaci√≥n para smart contracts** de verificaci√≥n
- **Simulaci√≥n de transacciones** on-chain
- **Interfaz Web3** preparada para MetaMask
- **Templates de contratos** Solidity para verificadores ZK

### Casos de uso demostrados:

1. **üîû Verificaci√≥n de edad para contenido adulto** - Sin revelar fecha de nacimiento
2. **üé´ Acceso a eventos** - Verificar elegibilidad sin exponer datos personales
3. **üè¶ KYC preservando privacidad** - Cumplir regulaciones sin comprometer privacidad
4. **üó≥Ô∏è Votaci√≥n an√≥nima** - Verificar elegibilidad manteniendo anonimato
5. **üéì Credenciales educativas** - Demostrar calificaciones sin revelar notas exactas

## üöÄ Instalaci√≥n y Configuraci√≥n

### Prerrequisitos

```bash
Node.js >= 18.0.0
npm >= 8.0.0
```

### Instalaci√≥n

```bash
# Clonar repositorio

cd zk-identity-demo

# Instalar dependencias
npm install

# Instalar Zenroom
npm install zenroom

# Desarrollo
npm run dev

# Producci√≥n
npm run build
npm run preview
```

### Estructura del proyecto

```
src/
‚îú‚îÄ‚îÄ routes/
‚îÇ   ‚îî‚îÄ‚îÄ +page.svelte              # P√°gina principal de la demo
‚îú‚îÄ‚îÄ lib/
‚îÇ   ‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ crypto/
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ IdentityManager.svelte    # Gestor de identidades
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ ProofGenerator.svelte     # Generador de pruebas ZK
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ ProofVerifier.svelte      # Verificador de pruebas
‚îÇ   ‚îî‚îÄ‚îÄ crypto/
‚îÇ       ‚îú‚îÄ‚îÄ zenroom/
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ identity.js       # Manejo de identidades digitales
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ proofs.js         # Operaciones de pruebas ZK
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ contracts.js      # Contratos Zencode reutilizables
‚îÇ       ‚îî‚îÄ‚îÄ stores/
‚îÇ           ‚îú‚îÄ‚îÄ identity.js       # Store de identidad (Svelte)
‚îÇ           ‚îî‚îÄ‚îÄ session.js        # Store de sesi√≥n criptogr√°fica
‚îî‚îÄ‚îÄ app.html
```

## üìù Gu√≠a de uso paso a paso

### 1. üÜî Crear tu Identidad Digital

1. **Abrir la aplicaci√≥n** en `http://localhost:5173`
2. **Completar el formulario** de identidad:
   - Nombre completo
   - Fecha de nacimiento
   - Nacionalidad
3. **Hacer clic en "Crear Identidad"**
4. **¬°Listo!** Tu identidad criptogr√°fica se genera autom√°ticamente

#### ¬øQu√© sucede internamente?
- Se generan 3 keypairs criptogr√°ficos (Coconut, BLS, ECDSA)
- Se calcula tu edad autom√°ticamente
- Se determina si eres mayor de edad (‚â•18 a√±os)
- Todo se guarda de forma segura en localStorage

### 2. üîê Generar Pruebas Zero Knowledge

1. **Navegar a "Generar Prueba"**
2. **Seleccionar tipo de prueba**:
   - **Age Over 18**: Demuestra que eres mayor de edad
   - **Age Range**: Demuestra edad en rango espec√≠fico
   - **Selective Disclosure**: Revela solo atributos espec√≠ficos
3. **Configurar par√°metros** (umbral de edad, atributos a revelar)
4. **Generar prueba** - ¬°Sin revelar datos personales!

#### Ejemplo de prueba de edad:
```json
{
  "type": "age_verification",
  "protocol": "coconut",
  "public": {
    "predicateType": "age_over",
    "threshold": 18,
    "protocol": "coconut"
  }
  // La prueba matem√°tica no revela tu edad exacta
}
```

### 3. üîç Verificar Pruebas

1. **Navegar a "Verificar"**
2. **Seleccionar m√©todo de verificaci√≥n**:
   - **Coconut**: Para threshold credentials
   - **BBS+**: Para selective disclosure
   - **Blockchain**: Verificaci√≥n on-chain simulada
3. **Pegar la prueba ZK** (o usar el ejemplo incluido)
4. **Configurar umbral** de edad (default: 18 a√±os)
5. **Verificar** - ¬°Obt√©n resultado sin acceder a datos personales!

#### Resultado de verificaci√≥n:
```
‚úÖ Verificaci√≥n Exitosa
‚úì Mayor de 18 a√±os - SIN revelar edad exacta
üìÖ Verificado el: 2025-01-18 10:30:15
üîê Protocolo: COCONUT
```

### 4. ‚õìÔ∏è Simulaci√≥n Blockchain

1. **Navegar a "Blockchain"**
2. **Explorar integraci√≥n Web3**:
   - Templates de smart contracts
   - Simulaci√≥n de verificaci√≥n on-chain
   - Estad√≠sticas de gas y transacciones

### 5. üìä Monitorear Estad√≠sticas

La aplicaci√≥n rastrea autom√°ticamente:
- **Identidades creadas**: Contador de identidades generadas
- **Pruebas generadas**: N√∫mero de ZK proofs creados
- **Verificaciones**: Exitosas y fallidas
- **Historial completo**: Todas las operaciones registradas

## üéØ C√≥mo adaptar para producci√≥n

### ‚ö†Ô∏è Esta es una DEMO educativa

La aplicaci√≥n actual incluye **datos simulados y claves hardcodeadas** para facilitar las pruebas. Para uso en producci√≥n, necesitas implementar:

### üîê 1. Emisores de Credenciales Reales

**Estado actual (DEMO):**
```javascript
// Claves p√∫blicas hardcodeadas para demo
const DEFAULT_ISSUER_KEYS = {
  coconut: "BBA6KpjwgGHEr4Q8u5hWk6k2q5K1KxWyAZrAKEHkV4JVFLvqKmNwV8bJdNcPVtjHU4JQX1DdRwK6W8VNvMJGKQ8UX"
};
```

**Producci√≥n requerida:**
```javascript
// Integraci√≥n con emisores reales
const PRODUCTION_ISSUERS = {
  government: {
    endpoint: "https://id.gov.es/api/credentials",
    publicKey: "REAL_GOVERNMENT_PUBLIC_KEY",
    certificateChain: ["cert1", "cert2", "root"]
  },
  university: {
    endpoint: "https://uni.edu/credentials",
    publicKey: "REAL_UNIVERSITY_PUBLIC_KEY"
  }
};
```

### üèõÔ∏è 2. Autoridades de Certificaci√≥n

**Implementar:**
- **PKI completa** con certificados X.509
- **Validaci√≥n de cadenas** de certificados
- **Verificaci√≥n de revocaci√≥n** (CRL/OCSP)
- **Rotaci√≥n de claves** autom√°tica

### üîó 3. Integraci√≥n Blockchain Real

**Estado actual (DEMO):**
```javascript
// Simulaci√≥n de verificaci√≥n on-chain
async function verifyOnBlockchain(proof) {
  await new Promise(resolve => setTimeout(resolve, 2000));
  return { success: "true", transaction_hash: "0x" + Math.random().toString(16) };
}
```

**Producci√≥n requerida:**
```javascript
// Conexi√≥n real a smart contracts
import { ethers } from 'ethers';

async function verifyOnBlockchain(proof) {
  const contract = new ethers.Contract(VERIFIER_ADDRESS, ABI, provider);
  const tx = await contract.verifyProof(
    proof.pi_v.c,
    proof.pi_v.rr,
    proof.sigma_prime.h_prime,
    { gasLimit: 500000 }
  );
  return await tx.wait();
}
```

### üóÑÔ∏è 4. Base de Datos y Persistencia

**Implementar:**
- **Base de datos criptogr√°fica** (PostgreSQL con extensiones crypto)
- **Esquemas de nullifiers** para prevenir double-spending
- **√çndices de verificaci√≥n** optimizados
- **Backup y recuperaci√≥n** de datos cr√≠ticos

### üõ°Ô∏è 5. Seguridad Avanzada

**Medidas requeridas:**
- **HSMs** (Hardware Security Modules) para claves cr√≠ticas
- **Encriptaci√≥n en tr√°nsito** (TLS 1.3+)
- **Encriptaci√≥n en reposo** (AES-256)
- **Auditor√≠a completa** de todas las operaciones
- **Rate limiting** y protecci√≥n DDoS
- **Penetration testing** regular

### üìã 6. Compliance y Regulaciones

**Cumplir con:**
- **GDPR** - Derecho al olvido, minimizaci√≥n de datos
- **eIDAS 2.0** - Regulaci√≥n europea de identidad digital
- **CCPA** - Regulaciones de privacidad de California
- **SOC 2 Type II** - Controles de seguridad
- **ISO 27001** - Gesti√≥n de seguridad de la informaci√≥n

### üöÄ 7. Infraestructura de Producci√≥n

**Implementar:**
- **Kubernetes** para orquestaci√≥n
- **Load balancers** con SSL termination
- **CDN global** para baja latencia
- **Monitoring y alertas** (Prometheus + Grafana)
- **Logging centralizado** (ELK Stack)
- **CI/CD pipeline** con tests de seguridad

### üíº 8. APIs y Integraciones

**Desarrollar:**
```javascript
// API REST para verificaciones
POST /api/v1/verify
{
  "proof": "...",
  "predicate": "age_over_18",
  "issuer": "government_id"
}

// Webhook para notificaciones
POST /webhooks/verification-complete
{
  "verification_id": "uuid",
  "result": "success",
  "timestamp": "2025-01-18T10:30:15Z"
}
```

## üß™ Testing y Desarrollo

### Ejecutar tests

```bash
# Tests unitarios
npm run test

# Tests de integraci√≥n
npm run test:integration

# Tests de criptograf√≠a
npm run test:crypto

# Coverage
npm run test:coverage
```

### Debugging

```bash
# Modo debug con logs detallados
DEBUG=true npm run dev

# Validar contratos Zencode
npm run validate:contracts

# Benchmark de rendimiento
npm run benchmark
```

## ü§ù Contribuir

### Desarrollo

1. **Fork** del repositorio
2. **Crear branch**: `git checkout -b feature/nueva-funcionalidad`
3. **Commit**: `git commit -m 'Add: nueva funcionalidad ZK'`
4. **Push**: `git push origin feature/nueva-funcionalidad`
5. **Pull Request**

### √Åreas de contribuci√≥n

- üîê **Nuevos protocolos ZK**: Implementar PLONK, STARK, etc.
- üåê **Integraciones blockchain**: Soporte para Polygon, Arbitrum, etc.
- üé® **UI/UX mejorado**: Componentes m√°s intuitivos
- üì± **Mobile**: Aplicaci√≥n m√≥vil con React Native
- üîß **Tooling**: CLIs para desarrolladores
- üìö **Documentaci√≥n**: Gu√≠as y tutoriales

## üìö Recursos adicionales

### Documentaci√≥n t√©cnica
- [Zenroom Documentation](https://zenroom.org)
- [Zencode Language Reference](https://dev.zenroom.org/zencode/)
- [Coconut Whitepaper](https://arxiv.org/abs/1802.07344)
- [BBS+ Signatures Spec](https://identity.foundation/bbs-signature/draft-bbs-signatures.html)



### Papers acad√©micos
- [Coconut: Threshold Issuance Selective Disclosure Credentials](https://arxiv.org/abs/1802.07344)
- [Anonymous Credentials Light](https://eprint.iacr.org/2013/516.pdf)
- [Short Group Signatures](https://crypto.stanford.edu/~dabo/pubs/papers/groupsigs.pdf)


**üîê Construido con ‚ù§Ô∏è usando Zenroom + SvelteKit**

*Esta demo muestra el potencial de Zero Knowledge Proofs para preservar la privacidad en aplicaciones de identidad digital. ¬°El futuro es privado por dise√±o!*